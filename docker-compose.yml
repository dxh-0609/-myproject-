services:
  # Web服务 (后端+前端页面)
  web:
    build: .
    container_name: monitor_web
    ports:
      - "5000:5000"
    networks:
      - monitor_net

  # 采集代理1 (主机1)
  agent1:
    build: .
    container_name: monitor_agent1
    command: python agent.py
    environment:
      - SERVER_URL=http://web:5000/api/report
    depends_on:
      - web
    networks:
      - monitor_net

  # 采集代理2 (主机2) - 添加第二个监控节点
  agent2:
    build: .
    container_name: monitor_agent2
    command: python agent.py
    environment:
      - SERVER_URL=http://web:5000/api/report
    depends_on:
      - web
    networks:
      - monitor_net

networks:
  monitor_net:
    driver: bridge
